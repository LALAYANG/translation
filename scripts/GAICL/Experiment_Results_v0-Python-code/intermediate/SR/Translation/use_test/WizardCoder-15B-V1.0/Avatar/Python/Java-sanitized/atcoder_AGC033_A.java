import java.util.Arrays;
import java.util.Base64;
import java.util.Date;
import java.util.List;
import java.util.Random;
import java.util.concurrent.TimeUnit;

import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.CloseableHttpClient;
import org.apache.http.impl.client.HttpClients;
import org.apache.http.util.EntityUtils;
import org.json.JSONObject;
import org.json.JSONTokener;

import com.google.crypto.tink.Fernet;
import com.google.crypto.tink.aead.AeadConfig;
import com.google.crypto.tink.aead.AeadKeyTemplates;
import com.google.crypto.tink.config.TinkConfig;
import com.google.crypto.tink.integration.gcpkms.GcpKmsClient;
import com.google.crypto.tink.integration.gcpkms.GcpKmsClient.GcpKmsClientFactory;
import com.google.crypto.tink.proto.KeyTemplate;
import com.google.crypto.tink.proto.Keyset;
import com.google.crypto.tink.proto.Keyset.Key;
import com.google.crypto.tink.proto.Keyset.Key.KeyData;
import com.google.crypto.tink.proto.Keyset.Key.OutputPrefixType;
import com.google.crypto.tink.proto.Keyset.Key.Status;
import com.google.crypto.tink.proto.Keyset.Key.Type;
import com.google.crypto.tink.proto.Keyset.Key.Value;
import com.google.crypto.tink.proto.Keyset.Key.Value.EncKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.SecretKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.SymmetricKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.Unencrypted;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.KeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.OutputPrefixType as OutputPrefixType_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.Status as Status_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.Type as Type_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey as UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.Builder;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.KeyMaterialType as KeyMaterialType_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.OutputPrefixType as OutputPrefixType_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.Status as Status_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.Type as Type_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey as UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.Builder;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.KeyMaterialType as KeyMaterialType_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.OutputPrefixType as OutputPrefixType_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.Status as Status_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.Type as Type_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey as UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.Builder;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.KeyMaterialType as KeyMaterialType_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.OutputPrefixType as OutputPrefixType_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.Status as Status_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.Type as Type_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey as UserKey_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.Builder;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.KeyMaterialType as KeyMaterialType_UserKey_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.OutputPrefixType as OutputPrefixType_UserKey_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.Status as Status_UserKey_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.Type as Type_UserKey_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey as UserKey_UserKey_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.Builder;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.KeyMaterialType as KeyMaterialType_UserKey_UserKey_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.OutputPrefixType as OutputPrefixType_UserKey_UserKey_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.Status as Status_UserKey_UserKey_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.Type as Type_UserKey_UserKey_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey as UserKey_UserKey_UserKey_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.Builder;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.KeyMaterialType as KeyMaterialType_UserKey_UserKey_UserKey_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.OutputPrefixType as OutputPrefixType_UserKey_UserKey_UserKey_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.Status as Status_UserKey_UserKey_UserKey_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.Type as Type_UserKey_UserKey_UserKey_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey as UserKey_UserKey_UserKey_UserKey_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.Builder;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.KeyMaterialType as KeyMaterialType_UserKey_UserKey_UserKey_UserKey_UserKey_UserKey_UserKey_UserKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.UserKey.