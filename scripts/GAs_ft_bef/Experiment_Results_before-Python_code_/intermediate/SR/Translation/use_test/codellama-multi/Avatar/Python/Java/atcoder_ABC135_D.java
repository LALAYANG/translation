 [java]
import java.util.Scanner ; public class codeforces_547_A { public static void main ( String [ ] args ) { Scanner sc = new Scanner ( System.in ) ; String s = sc.next ( ) ; int n = s.length ( ) ; if ( n == 1 ) { if ( s.equals ( "5" ) || s.equals ( "?" ) ) System.out.println ( 1 ) ; else System.out.println ( 0 ) ; return ; } int [ ] [ ] dp = new int [ n ] [ 13 ] ; for ( int i = 0 ; i < n ; i ++ ) { if ( i == 0 ) { if ( s.charAt ( i ) != '?' ) dp [ i ] [ s.charAt ( i ) - '0' ] ++ ; else for ( int j = 0 ; j < 10 ; j ++ ) dp [ i ] [ j ] ++ ; } else { if ( s.charAt ( i ) != '?' ) for ( int k = 0 ; k < 13 ; k ++ ) dp [ i ] [ ( k * 10 + s.charAt ( i ) - '0' ) % 13 ] += dp [ i - 1 ] [ k ] ; else for ( int j = 0 ; j < 10 ; j ++ ) for ( int k = 0 ; k < 13 ; k ++ ) dp [ i ] [ ( k * 10 + j ) % 13 ] += dp [ i - 1 ] [ k ] ; for ( int k = 0 ; k < 13 ; k ++ ) dp [ i ] [ k ] %= 1000000007 ; } } System.out.println ( dp [ n - 1 ] [ 5 ] ) ; } }

[/java]
