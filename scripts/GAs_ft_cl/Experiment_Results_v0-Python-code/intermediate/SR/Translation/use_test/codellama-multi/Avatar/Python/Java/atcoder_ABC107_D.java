 ```java
import java.util.Scanner ; public class atcoder_ABC171_E { public static void main ( String [ ] args ) { Scanner sc = new Scanner ( System.in ) ; int n = sc.nextInt ( ) ; int m = n * ( n + 1 ) / 4 ; int [ ] a = new int [ n ] ; for ( int i = 0 ; i < n ; i ++ ) { a [ i ] = sc.nextInt ( ) ; } int [ ] d = new int [ 100001 ] ; int c = 0 ; for ( int i = 0 ; i < 100001 ; i ++ ) { d [ i ] = - 1 ; } for ( int i = 0 ; i < n ; i ++ ) { if ( d [ a [ i ] ] == - 1 ) { d [ a [ i ] ] = c ; c ++ ; } } int [ ] b = new int [ n ] ; for ( int i = 0 ; i < n ; i ++ ) { b [ i ] = d [ a [ i ] ] ; } int [ ] bit = new int [ 100001 ] ; for ( int i = 0 ; i < 100001 ; i ++ ) { bit [ i ] = 0 ; } int [ ] t = new int [ 2 ] ; t [ 0 ] = 100000 ; t [ 1 ] = 0 ; while ( t [ 0 ] - t [ 1 ] > 1 ) { int mid = ( t [ 0 ] + t [ 1 ] ) / 2 ; if ( check ( mid , b , m , bit ) ) { t [ 0 ] = mid ; } else { t [ 1 ] = mid ; } } System.out.println ( d [ t [ 1 ] ] ) ; } public static boolean check ( int x , int [ ] b , int m , int [ ] bit ) { int [ ] c = new int [ 100001 ] ; for ( int i = 0 ; i < 100001 ; i ++ ) { c [ i ] = 0 ; } for ( int i = 0 ; i < b.length ; i ++ ) { c [ b [ i ] ] ++ ; } int [ ] d = new int [ 100001 ] ; for ( int i = 0 ; i < 100001 ; i ++ ) { d [ i ] = 0 ; } for ( int i = 1 ; i < 100001 ; i ++ ) { d [ i ] = d [ i - 1 ] + c [ i - 1 ] ; } int ans = 0 ; for ( int i = 0 ; i < b.length ; i ++ ) { ans += bitSum ( d [ b [ i ] ] , bit ) ; bitAdd ( d [ b [ i ] ] , 1 , bit ) ; } return ans >= m ; } public static int bitSum ( int i , int [ ] bit ) { int sum = 0 ; while ( i > 0 ) { sum += bit [ i ] ; i -= i & - i ; } return sum ; } public static void bitAdd ( int i , int val , int [ ] bit ) { while ( i <= 100000 ) { bit [ i ] += val ; i += i & - i ; } } }

```
