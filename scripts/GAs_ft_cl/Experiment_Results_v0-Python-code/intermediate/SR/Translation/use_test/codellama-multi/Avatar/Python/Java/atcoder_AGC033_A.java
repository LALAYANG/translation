 ```java
import java.util.Scanner ; public class atcoder_ABC171_E { public static void main ( String [ ] args ) { Scanner sc = new Scanner ( System.in ) ; int h = sc.nextInt ( ) ; int w = sc.nextInt ( ) ; int [ ] [ ] map = new int [ h ] [ w ] ; for ( int i = 0 ; i < h ; i ++ ) { for ( int j = 0 ; j < w ; j ++ ) { if ( sc.next ( ).equals ( "#" ) ) { map [ i ] [ j ] = 0 ; } else { map [ i ] [ j ] = Integer.MAX_VALUE ; } } } for ( int i = 0 ; i < h ; i ++ ) { for ( int j = 1 ; j < w ; j ++ ) { map [ i ] [ j ] = Math.min ( map [ i ] [ j ] , map [ i ] [ j - 1 ] + 1 ) ; } } for ( int i = 0 ; i < h ; i ++ ) { for ( int j = w - 2 ; j >= 0 ; j -- ) { map [ i ] [ j ] = Math.min ( map [ i ] [ j ] , map [ i ] [ j + 1 ] + 1 ) ; } } for ( int i = 1 ; i < h ; i ++ ) { for ( int j = 0 ; j < w ; j ++ ) { map [ i ] [ j ] = Math.min ( map [ i ] [ j ] , map [ i - 1 ] [ j ] + 1 ) ; } } for ( int i = h - 2 ; i >= 0 ; i -- ) { for ( int j = 0 ; j < w ; j ++ ) { map [ i ] [ j ] = Math.min ( map [ i ] [ j ] , map [ i + 1 ] [ j ] + 1 ) ; } } int ans = 0 ; for ( int i = 0 ; i < h ; i ++ ) { for ( int j = 0 ; j < w ; j ++ ) { ans = Math.max ( ans , map [ i ] [ j ] ) ; } } System.out.println ( ans ) ; } }

```
