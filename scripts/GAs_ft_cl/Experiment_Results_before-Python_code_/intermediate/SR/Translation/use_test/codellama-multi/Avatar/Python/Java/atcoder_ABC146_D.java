 ```java
import java.util.Scanner ; public class atcoder_ABC171_E { public static void main ( String [ ] args ) { Scanner sc = new Scanner ( System.in ) ; int n = sc.nextInt ( ) ; int [ ] [ ] g = new int [ n ] [ n ] ; int [ ] [ ] e = new int [ n ] [ n ] ; for ( int i = 0 ; i < n - 1 ; i ++ ) { int a = sc.nextInt ( ) - 1 ; int b = sc.nextInt ( ) - 1 ; g [ a ] [ b ] = 1 ; g [ b ] [ a ] = 1 ; e [ a ] [ b ] = 0 ; e [ b ] [ a ] = 0 ; } int k = bfs ( 0 , n , g , e ) ; System.out.println ( k ) ; for ( int i = 0 ; i < n ; i ++ ) { for ( int j = 0 ; j < n ; j ++ ) { System.out.print ( e [ i ] [ j ] + " " ) ; } System.out.println ( ) ; } } public static int bfs ( int s , int n , int [ ] [ ] g , int [ ] [ ] e ) { int [ ] v = new int [ n ] ; int [ ] c = new int [ n ] ; int k = 0 ; v [ s ] = 1 ; c [ s ] = 1 ; Queue < Integer > q = new LinkedList < > ( ) ; q.add ( s ) ; while ( ! q.isEmpty ( ) ) { int u = q.poll ( ) ; for ( int i = 0 ; i < n ; i ++ ) { if ( g [ u ] [ i ] == 1 && v [ i ] == 0 ) { v [ i ] = 1 ; c [ i ] = c [ u ] + 1 ; q.add ( i ) ; } } } for ( int i = 0 ; i < n ; i ++ ) { for ( int j = 0 ; j < n ; j ++ ) { if ( g [ i ] [ j ] == 1 ) { e [ i ] [ j ] = Math.min ( c [ i ] , c [ j ] ) ; } } } return k ; } }

```
