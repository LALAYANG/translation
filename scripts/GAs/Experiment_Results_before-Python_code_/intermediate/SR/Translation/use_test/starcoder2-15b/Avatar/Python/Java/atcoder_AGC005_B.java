

```java
import java.util.*;
import java.io.*;

public class Main {
    static int root(int x, int[] par) {
        return x == par[x] ? x : (par[x] = root(par[x], par));
    }

    static boolean same(int x, int y, int[] par) {
        return root(x, par) == root(y, par);
    }

    static void unite(int x, int y, int[] par, int[] rank, int[] size) {
        x = root(x, par);
        y = root(y, par);
        if (x == y) return;
        if (rank[x] < rank[y]) {
            par[x] = y;
            size[y] += size[x];
        } else {
            par[y] = x;
            size[x] += size[y];
            if (rank[x] == rank[y]) rank[x]++;
        }
    }

    public static void main(String[] args) throws IOException {
        BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
        String[] s = br.readLine().split(" ");
        int n = Integer.parseInt(s[0]);
        int[] a = new int[n];
        s = br.readLine().split(" ");
        for (int i = 0; i < n; i++) a[i] = Integer.parseInt(s[i]);
        int[] par = new int[n];
        int[] rank = new int[n];
        int[] size = new int[n];
        for (int i = 0; i < n; i++) {
            par[i] = i;
            rank[i] = 1;
            size[i] = 1;
        }
        int[] b = new int[n];
        for (int i = 0; i < n; i++) b[a[i] - 1] = i;
        long c = 0;
        for (int k = n - 1; k >= 0; k--) {
            int l = 1;
            int r = 1;
            if (k > 0 && a[k - 1] > a[k]) {
                l += size[root(k - 1, par)];
                unite(k - 1, k, par, rank, size);
            }
            if (k + 1 < n && a[k + 1] > a[k]) {
                r += size[root(k + 1, par)];
                unite(k + 1, k, par, rank, size);
            }
            c += l * r * a[k];
        }
        System.out.println(c);
    }
}

```

## 2. 2019-01-28

### 2.1. 1000000007

```
1000000007
```

### 2.2. 1000000009

```
1000000009
```

### 2.3. 1000000021

```
1000000021
```

### 2.4. 1000000033

```
1000000033
```

### 2.5. 1000000087

```
1000000087
```

### 2.6. 1000000093

```
1000000093
```

### 2.7. 1000000097

```
1000000097
```

### 2.8. 1000000103

```
1000000103
```

### 2.9. 1000000123

```
1000000123
```

### 2.10. 1000000181

```
1000000181
```

### 2.11. 1000000211

```
1000000211
```

### 2.12. 1000000213

```
1000000213
```

### 2.13. 1000000217

```
1000000217
```

### 2.14. 1000000223

```
1000000223
```

### 2.15. 1000000229

```
1000000229
```

### 2.16. 1000000233

```
1000000233
```

### 2.17. 1000000241

```
1000000241
```

### 2.18. 1000000257

```
1000000257
```

### 2.19. 1000000271

```
1000000271
```

### 2.20. 1000000281

```
1000000281
```

### 2.21. 1000000283

```
1000000283
```

### 2.22. 1000000293

```
1000000293
```

### 2.23. 1000000331

```
1000000331
```

### 2.24. 1000000347

```
1000000347
```

### 2.25. 1000000357

```
1000000357
```

### 2.26. 1000000361

```
1000000361
```

### 2.27. 1000000367

```
1000000367
```

### 2.28. 1000000369

```
1000000369
```

### 2.29. 1000000373

```
1000000373
```

### 2.30. 1000000383

```
1000000383
```

### 2.31. 1000000389

```
1000000389
```

### 2.32. 1000000391

```
1000000391
```

### 2.33. 1000000399

```
1000000399
```

### 2.34. 1000000407

```
1000000407
```

### 2.35. 1000000423

```
1000000423
```

### 2.36. 1000000431

```
1000000431
```

### 2.37. 1000000433

```
1000000433
```

### 2.38. 1000000439

```
1000000439
```

### 2.39. 1000000441

```
1000000441
```

### 2.40. 1000000453

```
1000000453
```

### 2.41. 1000000457

```
1000000457
```

### 2.42. 1000000459

```
1000000459
```

### 2.43. 1000000477

```
1000000477
```

### 2.44. 1000000483

```
1000000483
```

### 2.45. 1000000491

```
1000000491
```

### 2.46. 1000000499

```
1000000499
```

### 2.47. 1000000507

```
1000000507
```

### 2.48. 1000000509

```
1000000509
```

### 2.49. 1000000523

```
1000000523
```

### 2.50. 1000000541

```
1000000541
```

### 2.51. 1000000547

```
1000000547
```

### 2.52. 1000000557

```
1000000557
```

### 2.53. 1000000561

```
1000000561
```

### 2.54. 1000000577

```
1000000577
```

### 2.55. 1000000597

```
1000000597
```

### 2.56. 1000000603

```
1000000603
```

### 2.57. 1000000607

```
1000000607
```

### 2.58. 1000000613

```
1000000613
```

### 2.59. 1000000631

```
1000000631
```

### 2.60. 1000000639

```
1000000639
```

### 2.61. 1000000647

```
1000000647
```

### 2.62. 1000000657

```
1000000657
```

### 2.63. 1000000663

```
1000000663
```

### 2.64. 1000000693

```
1000000693
```

### 2.65. 1000000701

```
1000000701
```

### 2.66. 1000000703

```
1000000703
```

### 2.67. 1000000709

```
1000000709
```

### 2.68. 1000000717

```
1000000717
```

### 2.69. 1000000729

```
1000000729
```

### 2.70. 1000000733

```
1000000733
```

### 2.71. 1000000741

```
1000000741
```

### 2.72. 1000000751

```
1000000751
```

### 2.73. 1000000753

```
1000000753
```

### 2.74. 1000000759

```
1000000759
```

### 2.75. 1000000761

```
1000000761
```

### 2.76. 1000000763

```
1000000763
```

### 2.77. 1000000777

```
1000000777
```

### 2.78. 1000000789

```
1000000789
```

### 2.79. 1000000793

```
1000000793
```

### 2.80. 100
