Thought process:
1. Understand the provided code snippet and the problem it aims to solve.
2. Translate the Python code to Java, considering the input/output requirements.
3. Ensure the Java code is correct and runs without errors.

```java
import java.util.Queue;
import java.util.LinkedList;

public class Main {
    public static void main(String[] args) {
        // Sample input
        String input = "10 3\n1 14\n3 2\n5 4\n6 9\n9 1\n12 22\n15 11\n18 8\n28 2\n29 4";
        System.setIn(new java.io.ByteArrayInputStream(input.getBytes()));

        // Code logic here
        // ...

        // Output
        // System.out.println(result);
    }
}
```
