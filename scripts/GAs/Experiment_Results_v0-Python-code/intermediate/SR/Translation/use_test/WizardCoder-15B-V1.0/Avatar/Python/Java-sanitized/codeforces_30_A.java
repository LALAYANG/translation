import java.net.HttpURLConnection;
import java.net.URL;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.Base64;
import java.util.Date;
import java.util.Random;
import java.util.concurrent.TimeUnit;

import org.apache.commons.lang3.time.DateUtils;
import org.apache.http.client.methods.CloseableHttpResponse;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.CloseableHttpClient;
import org.apache.http.impl.client.HttpClients;
import org.apache.http.util.EntityUtils;
import org.json.JSONObject;
import org.json.JSONTokener;

import com.google.crypto.tink.Fernet;
import com.google.crypto.tink.aead.AeadConfig;
import com.google.crypto.tink.aead.AeadKeyTemplates;
import com.google.crypto.tink.config.TinkConfig;
import com.google.crypto.tink.integration.gcpkms.GcpKmsClient;
import com.google.crypto.tink.integration.gcpkms.GcpKmsClient.GcpKmsClientFactory;
import com.google.crypto.tink.integration.gcpkms.GcpKmsKeyManager;
import com.google.crypto.tink.proto.KeyTemplate;
import com.google.crypto.tink.proto.Keyset;
import com.google.crypto.tink.proto.Keyset.Key;
import com.google.crypto.tink.proto.Keyset.Key.KeyData;
import com.google.crypto.tink.proto.Keyset.Key.OutputPrefixType;
import com.google.crypto.tink.proto.Keyset.Key.Status;
import com.google.crypto.tink.proto.Keyset.Key.Type;
import com.google.crypto.tink.proto.Keyset.Key.Version;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.LuksKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.TinkKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.TypeUrl;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.AesSivKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.EciesAeadHkdfPrivateKey;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.EciesAeadHkdfPublicKey;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.HmacKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.KmsAeadKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.PbkdfKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.Pkcs8KeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.StatusType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.XChaCha20Poly1305KeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.XSalsa20Poly1305KeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.YubikeyKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.OutputPrefixType;
import com.google.crypto.tink.proto.Keyset.Key.OutputPrefixType.TinkOutputPrefixType;
import com.google.crypto.tink.proto.Keyset.Key.OutputPrefixType.RawPrefixType;
import com.google.crypto.tink.proto.Keyset.Key.Status;
import com.google.crypto.tink.proto.Keyset.Key.StatusType;
import com.google.crypto.tink.proto.Keyset.Key.Type;
import com.google.crypto.tink.proto.Keyset.Key.Version;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.LuksKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.TinkKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.TypeUrl;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.AesSivKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.EciesAeadHkdfPrivateKey;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.EciesAeadHkdfPublicKey;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.HmacKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.KmsAeadKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.PbkdfKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.Pkcs8KeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.StatusType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.XChaCha20Poly1305KeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.XSalsa20Poly1305KeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.YubikeyKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.OutputPrefixType;
import com.google.crypto.tink.proto.Keyset.Key.OutputPrefixType.TinkOutputPrefixType;
import com.google.crypto.tink.proto.Keyset.Key.OutputPrefixType.RawPrefixType;
import com.google.crypto.tink.proto.Keyset.Key.Status;
import com.google.crypto.tink.proto.Keyset.Key.StatusType;
import com.google.crypto.tink.proto.Keyset.Key.Type;
import com.google.crypto.tink.proto.Keyset.Key.Version;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.LuksKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.TinkKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.TypeUrl;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.AesSivKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.EciesAeadHkdfPrivateKey;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.EciesAeadHkdfPublicKey;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.HmacKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.KmsAeadKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.PbkdfKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.Pkcs8KeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.StatusType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.XChaCha20Poly1305KeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.XSalsa20Poly1305KeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.YubikeyKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.OutputPrefixType;
import com.google.crypto.tink.proto.Keyset.Key.OutputPrefixType.TinkOutputPrefixType;
import com.google.crypto.tink.proto.Keyset.Key.OutputPrefixType.RawPrefixType;
import com.google.crypto.tink.proto.Keyset.Key.Status;
import com.google.crypto.tink.proto.Keyset.Key.StatusType;
import com.google.crypto.tink.proto.Keyset.Key.Type;
import com.google.crypto.tink.proto.Keyset.Key.Version;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.LuksKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.TinkKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.TypeUrl;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.AesSivKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.EciesAeadHkdfPrivateKey;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.EciesAeadHkdfPublicKey;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.HmacKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.KmsAeadKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.PbkdfKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.Pkcs8KeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.StatusType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.XChaCha20Poly1305KeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.XSalsa20Poly1305KeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.YubikeyKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.OutputPrefixType;
import com.google.crypto.tink.proto.Keyset.Key.OutputPrefixType.TinkOutputPrefixType;
import com.google.crypto.tink.proto.Keyset.Key.OutputPrefixType.RawPrefixType;
import com.google.crypto.tink.proto.Keyset.Key.Status;
import com.google.crypto.tink.proto.Keyset.Key.StatusType;
import com.google.crypto.tink.proto.Keyset.Key.Type;
import com.google.crypto.tink.proto.Keyset.Key.Version;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.LuksKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.TinkKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.TypeUrl;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.AesSivKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.EciesAeadHkdfPrivateKey;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.EciesAeadHkdfPublicKey;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.HmacKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.KmsAeadKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.PbkdfKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.Pkcs8KeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.StatusType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.XChaCha20Poly1305KeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.XSalsa20Poly1305KeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.YubikeyKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.OutputPrefixType;
import com.google.crypto.tink.proto.Keyset.Key.OutputPrefixType.TinkOutputPrefixType;
import com.google.crypto.tink.proto.Keyset.Key.OutputPrefixType.RawPrefixType;
import com.google.crypto.tink.proto.Keyset.Key.Status;
import com.google.crypto.tink.proto.Keyset.Key.StatusType;
import com.google.crypto.tink.proto.Keyset.Key.Type;
import com.google.crypto.tink.proto.Keyset.Key.Version;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.LuksKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.TinkKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.TypeUrl;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.AesSivKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.EciesAeadHkdfPrivateKey;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.EciesAeadHkdfPublicKey;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.HmacKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.KmsAeadKeyMaterialType;
import com.google.crypto.tink.proto.Keyset.Key.KeyMaterialType.Pbkdf