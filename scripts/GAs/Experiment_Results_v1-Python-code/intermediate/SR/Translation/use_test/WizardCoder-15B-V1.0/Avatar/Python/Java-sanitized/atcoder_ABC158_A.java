import java.net.HttpURLConnection;
import java.net.URL;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.util.Base64;
import java.util.Random;
import java.util.concurrent.TimeUnit;

import org.apache.commons.lang3.time.DateUtils;
import org.apache.http.client.methods.CloseableHttpResponse;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.CloseableHttpClient;
import org.apache.http.impl.client.HttpClients;
import org.apache.http.util.EntityUtils;
import org.json.JSONObject;

import com.google.crypto.tink.Fernet;
import com.google.crypto.tink.aead.AeadConfig;
import com.google.crypto.tink.aead.AeadKeyTemplates;
import com.google.crypto.tink.config.TinkConfig;
import com.google.crypto.tink.integration.gcpkms.GcpKmsClient;
import com.google.crypto.tink.integration.gcpkms.GcpKmsClient.GcpKmsClientFactory;
import com.google.crypto.tink.proto.KeyTemplate;
import com.google.crypto.tink.proto.Keyset;
import com.google.crypto.tink.proto.Keyset.Key;
import com.google.crypto.tink.proto.Keyset.Key.KeyData;
import com.google.crypto.tink.proto.Keyset.Key.OutputPrefixType;
import com.google.crypto.tink.proto.Keyset.Key.Status;
import com.google.crypto.tink.proto.Keyset.Key.Type;
import com.google.crypto.tink.proto.Keyset.Key.ValueCase;
import com.google.crypto.tink.proto.Keyset.Key.Value;
import com.google.crypto.tink.proto.Keyset.Key.Value.EncKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.HmacKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.RawKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.RsaSsaPkcs1PrivateKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.RsaSsaPkcs1PublicKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.SymmetricKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.UnparsedKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.XChaCha20Poly1305Key;
import com.google.crypto.tink.proto.Keyset.Key.Value.YubikeyKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKey;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.EcParams;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.EcParams.CurveType;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.EcParams.HashType;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.EcParams.PointFormatType;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.RsaParams;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.RsaParams.HashType;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.SchnorrParams;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.SchnorrParams.HashType;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.SchnorrParams.SchnorrVariant;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.SchnorrParams.SignatureType;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.CurveType;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.HashType;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.PointFormatType;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.SignatureType;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.Variant;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVariant;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V1;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V2;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V3;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V4;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V5;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V6;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V7;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V8;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V9;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V10;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V11;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V12;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V13;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V14;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V15;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V16;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V17;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V18;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V19;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V20;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V21;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V22;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V23;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V24;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V25;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V26;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V27;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V28;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V29;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V30;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V31;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V32;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V33;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V34;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V35;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V36;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V37;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V38;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V39;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V40;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V41;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V42;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V43;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V44;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V45;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V46;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V47;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V48;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V49;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V50;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V51;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V52;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V53;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V54;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V55;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V56;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.ZkpVersion.Version.V57;
import com.google.crypto.tink.proto.Keyset.Key.Value.ZkpKeyFormat.Params.ZkpParams.Zkp